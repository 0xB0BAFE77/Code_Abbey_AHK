#SingleInstance Force
#Warn
code_abbey.input_box()          ; Runs user input box
Return

*Esc::ExitApp                   ; Emergency killswitch

Class code_abbey
{
    Static hwnd := {}           ; Stores all gui handles
    Static ws   := " `t`r`n"    ; Whitespace
    
    ; Creates multi-line input box
    input_box() {
        Local
        ; GUI size properties
        hwnd   := ""
        edit_w := 400
        edit_h := 300
        btn_w  := 100
        btn_h  := 25
        btn_x  := edit_w - btn_w
        
        Gui, CIB:New,                                                       ; New gui
            this.hwnd.gui := hwnd
        Gui, Margin, 5, 5
        Gui, Font,, Courier New
        Gui, Font,, Consolas
        Gui, Add, Edit, xm ym w%edit_w% h%edit_h% +Multi HWNDhwnd           ; Add large edit box for pasting multiple case sets
            this.hwnd.edit := hwnd
        Gui, Add, Button, xm y+m w%btn_w% h%btn_h% HWNDhwnd, Submit         ; Submit button
            this.hwnd.btn_submit := hwnd
            bf := ObjBindMethod(this, "Submit")
            GuiControl, +g, % hwnd, % bf
        Gui, Add, Button, xm+%btn_x% yp w%btn_w% h%btn_h% HWNDhwnd, Cancel  ; Cancel button
            this.hwnd.btn_cancel := hwnd
            bf := ObjBindMethod(this, "Quit")
            GuiControl, +g, % hwnd, % bf
        Gui, Show, AutoSize
        
        Return
    }
    
    ; Submits data to be verified and operated on
    Submit() {
        Local
        
        GuiControlGet, data,, % this.hwnd.edit          ; Get data
        GuiControl,, % this.hwnd.edit, % ""             ; Empty data box
        
        case_arr := StrSplit(data, " ")
        this.check(case_arr)                            ; Verify data and check for errors
        result := this.array_min_max(case_arr)          ; Assign each result
        
        MsgBox, 0x4, Finished, % "Save results to the clipboard?"
            . "`n`nResults:`n" result
        IfMsgBox, Yes
            Clipboard := result
        ExitApp
    }
    
    ; Validate input
    Check(case_arr) {
        Local
        example := "1 300 11 ... 295 4 2"
        
        For key, value in case_arr
            If !this.is_int(value)
                this.error(""
                    , value
                    , "integer"
                    , example )
        
        If (case_arr.MaxIndex() != 300)
            this.error("Exactly 300 numbers should be supplied."
                , case_arr.MaxIndex()
                , 300
                , example )
        
        Return True
    }
    
    array_min_max(case) {
        Local
        
        For index, value in case
            If (index = 1)
                min := max := value
            Else
                (value > max) ? max := value 
                : (value < min) ? min := value
                : ""
        
        Return (max " " min)
    }
    
    ; Error handling
    error(msg, found, expected, example) {
        MsgBox, 0x0, % "Error found!"
            , % msg
            . "`nFound: " found
            . "`nExpected: " expected
            . "`nExample: " example
        Exit
    }
    
    Quit() {
        ExitApp
    }
    
    ; Check if integer
    is_int(num) {
        Return (Mod(num, 1) = 0)
    }
    
    ; Check if number
    is_num(num) {
        Return (num + 0 != "")
    }
    
    ; Check if positive number
    is_pos_num(num) {
        Return (num + 0 > 0)
    }
}

/*
; This version is the "first line has case numbers" setup
#SingleInstance Force
#Warn
code_abbey.input_box()          ; Runs user input box
Return

*Esc::ExitApp                   ; Emergency killswitch

Class code_abbey
{
    Static hwnd := {}           ; Stores all gui handles
    Static ws   := " `t`r`n"    ; Whitespace
    
    ; Creates multi-line input box
    input_box() {
        Local
        ; GUI size properties
        hwnd   := ""
        edit_w := 400
        edit_h := 300
        btn_w  := 100
        btn_h  := 25
        btn_x  := edit_w - btn_w
        
        Gui, CIB:New,                                                       ; New gui
            this.hwnd.gui := hwnd
        Gui, Margin, 5, 5
        Gui, Font,, Courier New
        Gui, Font,, Consolas
        Gui, Add, Edit, xm ym w%edit_w% h%edit_h% +Multi HWNDhwnd           ; Add large edit box for pasting multiple case sets
            this.hwnd.edit := hwnd
        Gui, Add, Button, xm y+m w%btn_w% h%btn_h% HWNDhwnd, Submit         ; Submit button
            this.hwnd.btn_submit := hwnd
            bf := ObjBindMethod(this, "Submit")
            GuiControl, +g, % hwnd, % bf
        Gui, Add, Button, xm+%btn_x% yp w%btn_w% h%btn_h% HWNDhwnd, Cancel  ; Cancel button
            this.hwnd.btn_cancel := hwnd
            bf := ObjBindMethod(this, "Quit")
            GuiControl, +g, % hwnd, % bf
        Gui, Show, AutoSize
        
        Return
    }
    
    ; Submits data to be verified and operated on
    Submit() {
        Local
        GuiControlGet, data,, % this.hwnd.edit              ; Get data
        GuiControl,, % this.hwnd.edit, % ""                 ; Empty data box
        
        case_total := 0
        case_arr   := []
        
        Loop, Parse, % data, % "`n", % "`r"                 ; Parse data in an array
            If (A_Index = 1)                                ; First line contains total cases
                case_total := A_LoopField
            Else case_arr := StrSplit(A_LoopField, " ")     ; Add all cases to array
        
        this.check(case_total, case_arr)                    ; Verify data and check for errors
        
        result := ""
        For case_num, case in case_arr                      ; Loop through each case
            result .= this.modular_calc(case) " "           ; Assign each result
        result := RTrim(result, " ")                        ; Trim off end space
        
        MsgBox, 0x4, Finished, % "Save results to the clipboard?"
            . "`n`nResults:`n" result
        IfMsgBox, Yes
            Clipboard := result
        ExitApp
    }
    
    ; Validate input
    Check(total, cases) {
        Local
        example := "3`n9 15 1776"
        
        If (total != cases.MaxIndex())                                              ; Verify that first line matches total number of cases
            this.error("Case total number does not match actual total of cases."
                , total
                , cases.MaxIndex()
                , example)
        
        For case_num, case in cases                                                 ; Verify each case has 8 numbers
            For index, value in case
                If !(this.is_pos_int(value))
                    this.error("Cases can only contain positive integers."
                        , value
                        , "integer"
                        , example)
        
        Return True
    }
    
    modular_calc(case) {
        Local
        
        Return
    }
    
    ; Error handling
    error(msg, found, expected, example) {
        MsgBox, 0x0, % "Error found!"
            , % msg
            . "`nFound: " found
            . "`nExpected: " expected
            . "`nExample: " example
        Exit
    }
    
    Quit() {
        ExitApp
    }
    
    ; Check if integer
    is_int(num) {
        Return (Mod(num, 1) = 0)
    }
    
    ; Check if number
    is_num(num) {
        Return (num + 0 != "")
    }
    
    ; Check if positive number
    is_pos_num(num) {
        Return (num + 0 > 0)
    }

}
*/
